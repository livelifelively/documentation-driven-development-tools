# T31: Refactor Doc-Parser with Generated Types

## 1 Meta & Governance

### 1.2 Status

- **Current State:** ðŸ’¡ Not Started
- **Priority:** ðŸŸ¥ High
- **Progress:** 0%
- **Planning Estimate:** 8
- **Est. Variance (pts):** 0
- **Created:** 2025-08-02 09:44
- **Implementation Started:**
- **Completed:**
- **Last Updated:** 2025-08-02 09:44

### 1.3 Priority Drivers

- [TEC-Prod_Stability_Blocker](../ddd-2.md#tec-prod_stability_blocker)
- [TEC-Dev_Productivity_Enhancement](../ddd-2.md#tec-dev_productivity_enhancement)

---

## 2 Business & Scope

### 2.1 Overview

- **Core Function**: This task is to refactor the `doc-parser` module to use the canonical, strongly-typed interfaces generated from the documentation schema.
- **Key Capability**: It will replace the manually-defined, generic output types with the new, authoritative types from `src/schema/schema.types.ts`.
- **Business Value**: This will make the entire parsing engine more robust, reliable, and easier to maintain. It ensures that the data extracted by the parser always conforms to the master schema, eliminating a major source of potential bugs.

### 2.4 Acceptance Criteria

| ID   | Criterion                                                                                                               | Test Reference                |
| :--- | :---------------------------------------------------------------------------------------------------------------------- | :---------------------------- |
| AC-1 | The `CoreEngine` and `PluginManager` are updated to use types from `src/schema/schema.types.ts`.                        | `core-engine.test.ts`         |
| AC-2 | The `SectionProcessor` interface in `plugin.types.ts` is updated to reflect the new strongly-typed approach.            | `plugin-manager.test.ts`      |
| AC-3 | The `status.plugin.ts` is updated to import its data shape from the canonical types and return a strongly-typed object. | `status.plugin.test.ts`       |
| AC-4 | The manual `TaskData` interface is removed from `plugin.types.ts`.                                                      | N/A                           |
| AC-5 | All tests for the `doc-parser` module pass after the refactoring.                                                       | `npm test -- src/doc-parser/` |

---

## 3 Planning & Decomposition

### 3.3 Dependencies

| ID  | Dependency On                 | Type     | Status         | Affected Plans/Tasks | Notes                                               |
| :-- | :---------------------------- | :------- | :------------- | :------------------- | :-------------------------------------------------- |
| D-1 | Plan `p1.p6-schema-integrity` | Internal | ðŸ’¡ Not Started | This task            | The canonical types and validator must exist first. |

---

## 6 Implementation Guidance

### 6.1 Implementation Log / Steps

- [ ] Confirm that Plan `p1.p6` is complete and `src/schema/schema.types.ts` exists.
- [ ] Modify `plugin.types.ts`: remove `TaskData`, and update `ParseResult` and `SectionProcessor` to use the new types.
- [ ] Modify `core-engine.ts` to work with the new strongly-typed data from plugins.
- [ ] Modify `status.plugin.ts` to import its type from `schema.types.ts` and use it as the return type for the `extract` method.
- [ ] Update all related unit and integration tests in `src/doc-parser/__tests__/` to reflect the new types and data structures.
- [ ] Run all tests to ensure the refactoring is complete and correct.
